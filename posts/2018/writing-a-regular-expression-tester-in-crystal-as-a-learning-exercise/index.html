<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Writing a Regular Expression Tester in Crystal as a Learning Exercise | QBart&#39;s log</title>
  <meta content="" name="keywords">
  <meta content="Writing a Regular Expression Tester in Crystal as a Learning Exercise | QBart&#39;s log" property="og:title">
  <meta content="" property="og:description">

  <meta itemprop="name" content="Writing a Regular Expression Tester in Crystal as a Learning Exercise">
  <meta itemprop="description" content="">
  
  <meta itemprop="datePublished" content="2018-06-08T18:00:00&#43;02:00" />
  <meta itemprop="dateModified" content="2018-06-08T18:00:00&#43;02:00" />
  <meta itemprop="wordCount" content="574">
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="/"/>
  <meta name="twitter:title" content="Writing a Regular Expression Tester in Crystal as a Learning Exercise"/>
  <meta name="twitter:description" content=""/>
  <meta property="article:published_time" content="2018-06-08T18:00:00&#43;02:00" />

  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Titillium+Web:300,300i,400,400i,600,600i,700,700i,900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="/css/normalize.css" />
  <link rel="stylesheet" href="/css/fonts.css" />
  <link rel="stylesheet" href="/css/style.css" />
  <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
</head>

<body>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-left">
        <a href="/">
          tail -f qbart.dev.log
        </a>
      </div>

      <div class="navbar-right is-desktop">
        
        <a href="/projects/">Open source</a>
        
      </div>

      <div class="navbar-right is-mobile">
        <a id="a-burger">
          <i class="closed fas fa-bars"></i>
          <i class="opened fas fa-times"></i>
        </a>
      </div>

      <div id="submenu">
        
        <a href="/projects/">
          Open source
        </a>
        
      </div>
    </div>
  </nav>
  <div class="container content">

<div class="article-meta">
  <h1><span class="title">Writing a Regular Expression Tester in Crystal as a Learning Exercise</span></h1>
  
  <h2 class="date">2018/06/08</h2>
  <div class="tags">
    <a href="/tags/regex/" class="tag">#regex</a>
    
    <a href="/tags/crystal/" class="tag">#crystal</a>
    
    <a href="/tags/regular-expressions/" class="tag">#regular expressions</a>
    
  </div>
</div>

<main>
  

<figure class="image">
    <img src="/posts/2018/crystular.png" >
    <figcaption>App screenshot</figcaption>
</figure>


<h2 id="tl-dr-for-those-in-a-rush">TL;DR for those in a rush</h2>

<p>I did this: <a href="http://www.crystular.org/">http://www.crystular.org/</a>.
This article was originally published <a href="https://medium.com/selleo/writing-a-regular-expression-tester-in-crystal-as-a-learning-exercise-481935d6672f">here</a>.</p>

<h2 id="boring-introduction">Boring introduction</h2>

<p>As a part-time Rubyist, I couldn&rsquo;t ignore <a href="https://crystal-lang.org/">Crystal</a> any longer (+ I enjoy learning new programming languages) so I decided to give it a try. Because I wanted to write something useful and contribute to the community, I was looking for a small idea in the Ruby world and spoiler alert… I found it.</p>

<p>One of my favourite online tools is <a href="https://rubular.com/">Rubular</a> - a regular expression tester for Ruby so I&rsquo;ve decided to make a copy of it for Crystal because every programming language needs one.</p>

<h2 id="notes-about-regex-engine">Notes about regex engine</h2>

<p>Crystal uses <a href="http://www.pcre.org/">PCRE</a> which is a C library for regular expressions. For a contrast, Ruby uses Onigmo library (since 2.x). There are few differences that are worth mentioning between Crystal integration of PCRE and regex library itself.</p>

<p>Firstly, PCRE offers support for other encodings but Crystal strings are UTF-8 only, therefore regular expressions must be UTF-8 too.</p>

<p>Secondly, one of the regex options in Crystal is a multiline match denoted by <code>&quot;m&quot;</code> flag that translates into a combination of two separate options in PCRE:</p>

<ul>
<li><strong>PCRE_DOTALL</strong> - changes the behavior of <code>.</code> in regex</li>
<li><strong>PCRE_MULTILINE</strong> - changes the behavior of <code>^</code> and <code>$</code> in regex</li>
</ul>

<p>FYI, Ruby does it too in its own engine.</p>

<h2 id="implementation">Implementation</h2>

<p>While working on the project I wanted to add some minor tweaks that would improve, in my opinion, your <em>&ldquo;regular expression testing experience&rdquo;</em>. Here is the list of what I had planned:</p>

<ul>
<li><p>improved whitespace characters display and turned on by default (every space/tab/newline is rendered as a special character in a different color)</p></li>

<li><p>clearer distinction when matched strings are next to each other (matches are highlighted with rounded corners selection)</p></li>

<li><p>extended reference sheet by adding examples like &ldquo;positive lookbehind&rdquo; because who remembers that syntax? (not me, I need to google it every time)</p></li>
</ul>

<p>Once my goals were set, I had to choose web framework and I had a couple options here: <a href="https://amberframework.org/">Amber</a>, <a href="https://luckyframework.org/">Lucky</a> and <a href="https://kemalcr.com/">Kemal</a>. I went with Kemal as it seemed like a no-brainer, considering the size of the application (two endpoints, one view). Deployment to Heroku was also a breeze thanks to the existing <a href="https://github.com/crystal-lang/heroku-buildpack-crystal">buildpack</a>.</p>

<p>Because of the statically type-checked nature of the language doing TDD requires a bit different approach especially, if you declare your types explicitly - sometimes you just need to write some dummy code in the method just to make compilation successful. The same affects <code>nils</code>, crystal will know if your code results in <code>nil</code> so the compilation process might fail, but that&rsquo;s just Crystal having your back and protecting you from unhandled exceptions.</p>

<p>There were a few occasions when I had to intensively browse the code in GitHub to understand Kemal or Crystal standard library but this is a part of the learning process so I am fine with it. Also, these projects are still young, at that stage, it&rsquo;s pretty normal.</p>

<p>Things I wish to see improved are better support for specs, it&rsquo;s quite ok now but I guess <a href="https://github.com/rspec">RSpec</a> spoiled me, and I am hoping for some solid debugging process.</p>

<p>The code can be found <a href="https://github.com/Selleo/crystular">here</a>.</p>

<h2 id="closing-thoughts">Closing thoughts</h2>

<p>After finishing the project, I was happy with the result and the things I&rsquo;ve learned. It was surprising how quickly you can transition to Crystal having a background in Ruby so if you are a Rubyist, I recommend you to try Crystal out.</p>

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "qbart" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</main>

</div>

<footer>
  <div class="container">
    <nav>
      <a href="https://github.com/qbart">
        <span class="icon is-small">
          <i class="fab fa-github" aria-hidden="true"></i>
        </span>
        <span>GitHub</span>
      </a>

      <a href="https://twitter.com/_qbart">
        <span class="icon is-small">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </span>
        <span>Twitter</span>
      </a>

      <a href="https://www.linkedin.com/in/bartlomiej-wojtowicz-24b58b1b">
        <span class="icon is-small">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </span>
        <span>LinkedIn</span>
      </a>

      <a href="https://pinterest.com/bartlomiejwojtowicz/">
        <span class="icon is-small">
          <i class="fab fa-pinterest" aria-hidden="true"></i>
        </span>
        <span>Pinterest</span>
      </a>
    </nav>
    <div class="footnote">
      &copy; Bartłomiej Wójtowicz
    </div>
  </div>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const burger = document.getElementById('a-burger');

    burger.addEventListener('click', () => {
      document.body.classList.toggle('burger-open');
    });
  });
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143750284-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-143750284-1');
</script>

</body>

</html>

